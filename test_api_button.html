<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RouterSploit Console Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background-color: #1a1a1a; color: #00ff00; }
        .console-output { 
            background: #000; 
            border: 1px solid #00ff00; 
            font-family: monospace; 
            padding: 10px; 
            height: 400px; 
            overflow-y: auto; 
        }
        .console-line { margin-bottom: 5px; }
        .console-line.command { color: #ffff00; }
        .console-line.error { color: #ff0000; }
        .console-line.warning { color: #ff8800; }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1><i class="fas fa-terminal"></i> Console Fix Test</h1>
        
        <div class="card bg-dark text-light">
            <div class="card-header">
                <h5>Console Status: <span id="consoleStatus" class="badge bg-warning">Testing...</span></h5>
                <button id="clearConsoleBtn" class="btn btn-sm btn-outline-light">Clear</button>
            </div>
            <div class="card-body">
                <div id="consoleOutput" class="console-output">
                    <div class="console-line">RouterSploit Console Test - Ready</div>
                </div>
                <div class="input-group mt-2">
                    <span id="consolePrompt" class="input-group-text bg-dark text-light">test > </span>
                    <input type="text" id="consoleInput" class="form-control font-monospace bg-dark text-light" 
                           placeholder="Type 'help' for commands..." autocomplete="off">
                    <button id="consoleSendBtn" class="btn btn-primary">Send</button>
                </div>
            </div>
        </div>
        
        <div class="mt-3">
            <h6>Test Commands:</h6>
            <button class="btn btn-sm btn-outline-info me-2" onclick="testCommand('help')">help</button>
            <button class="btn btn-sm btn-outline-info me-2" onclick="testCommand('status')">status</button>
            <button class="btn btn-sm btn-outline-info me-2" onclick="testCommand('test')">test</button>
            <button class="btn btn-sm btn-outline-info me-2" onclick="testCommand('history')">history</button>
            <button class="btn btn-sm btn-outline-warning" onclick="testCommand('clear')">clear</button>
        </div>
    </div>

    <script>
        // Minimal RouterSploit GUI implementation for testing
        class TestRouterSploitGUI {
            constructor() {
                this.consoleConnected = false;
                this.commandHistory = [];
                this.historyIndex = -1;
                this.currentPrompt = 'test > ';
                
                this.setupConsoleEventHandlers();
                console.log('✅ Test console initialized');
                
                // Simulate offline mode immediately
                setTimeout(() => {
                    this.enableConsoleInput(true);
                    this.updateConsoleStatus('Offline Mode', 'warning');
                    this.addConsoleOutput('Console is in offline test mode.', 'info');
                    this.addConsoleOutput('Type "help" to see available commands.', 'info');
                }, 500);
            }
            
            setupConsoleEventHandlers() {
                const consoleInput = document.getElementById('consoleInput');
                const consoleSendBtn = document.getElementById('consoleSendBtn');
                const clearConsoleBtn = document.getElementById('clearConsoleBtn');
                
                consoleInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.sendConsoleCommand();
                    }
                });
                
                consoleSendBtn.addEventListener('click', () => {
                    this.sendConsoleCommand();
                });
                
                clearConsoleBtn.addEventListener('click', () => {
                    this.clearConsole();
                });
            }
            
            sendConsoleCommand() {
                const consoleInput = document.getElementById('consoleInput');
                const command = consoleInput.value.trim();
                
                if (!command) return;
                
                this.commandHistory.push(command);
                this.addConsoleOutput(`${this.currentPrompt}${command}`, 'command');
                consoleInput.value = '';
                
                this.handleOfflineCommand(command);
            }
            
            handleOfflineCommand(command) {
                let response = '';
                
                switch(command.toLowerCase()) {
                    case 'help':
                        response = `Available Test Commands:
- help          Show this help
- status        Show console status  
- test          Test console functionality
- history       Show command history
- clear         Clear console output
- hello         Say hello
- echo [text]   Echo back text`;
                        break;
                        
                    case 'status':
                        response = `Console Status:
✅ Frontend: Working
✅ Input: Functional
✅ Commands: ${this.commandHistory.length} executed
⚠️ Backend: Test mode (no real backend)`;
                        break;
                        
                    case 'test':
                        response = `🧪 Console Test Results:
✅ Input field: Working
✅ Button clicks: Working  
✅ Enter key: Working
✅ Command processing: Working
✅ Output display: Working
✅ History: Working

Console is fully functional! 🎉`;
                        break;
                        
                    case 'clear':
                        this.clearConsole();
                        return;
                        
                    case 'history':
                        if (this.commandHistory.length > 0) {
                            response = `Command History:\n${this.commandHistory.map((cmd, i) => `${i + 1}. ${cmd}`).join('\n')}`;
                        } else {
                            response = 'No commands in history.';
                        }
                        break;
                        
                    case 'hello':
                        response = 'Hello! The console is working perfectly! 👋';
                        break;
                        
                    default:
                        if (command.startsWith('echo ')) {
                            response = command.substring(5);
                        } else {
                            response = `Unknown command: "${command}". Type 'help' for available commands.`;
                        }
                }
                
                setTimeout(() => {
                    this.addConsoleOutput(response, 'info');
                }, 100);
            }
            
            addConsoleOutput(text, level = 'info') {
                const consoleOutput = document.getElementById('consoleOutput');
                const line = document.createElement('div');
                line.className = `console-line ${level}`;
                line.textContent = text;
                consoleOutput.appendChild(line);
                consoleOutput.scrollTop = consoleOutput.scrollHeight;
            }
            
            clearConsole() {
                const consoleOutput = document.getElementById('consoleOutput');
                consoleOutput.innerHTML = '<div class="console-line">Console cleared</div>';
            }
            
            enableConsoleInput(enabled) {
                const consoleInput = document.getElementById('consoleInput');
                const consoleSendBtn = document.getElementById('consoleSendBtn');
                
                consoleInput.disabled = !enabled;
                consoleSendBtn.disabled = !enabled;
                
                if (enabled) {
                    consoleInput.focus();
                }
            }
            
            updateConsoleStatus(text, type) {
                const statusBadge = document.getElementById('consoleStatus');
                statusBadge.textContent = text;
                statusBadge.className = `badge bg-${type}`;
            }
        }
        
        function testCommand(cmd) {
            const input = document.getElementById('consoleInput');
            input.value = cmd;
            window.testGUI.sendConsoleCommand();
        }
        
        // Initialize test GUI
        window.testGUI = new TestRouterSploitGUI();
    </script>
</body>
</html> 